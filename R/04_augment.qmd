---
title: "04_augment.qmd"
subtitle: "R for Bio Data Science"
format: html
author: All
date: "2023-11-15"
editor: visual
---

## Load libraries

```{r}
library("tidyverse")
library("here")
library("readxl")
library("tidyclust")
library("tidymodels")
source(here("R/99_proj_func.R"))
```

## Load data

```{r}
# Load data
data <- read_tsv(here("data/02_dat_clean.tsv"))
```

## Add catagorial progresstion

Add colums of progression as catagorical from a contiunes variable

```{r}
# adds cataorical colum surviral based on how many months a person survived.
# adds after meta data colums to keep structor of meta - gene data

data <- data |> 
  mutate( survival = case_when(
    overall_survival_months < 6 ~ "terrible",
    overall_survival_months < 12 ~ "Bad",
    overall_survival_months < 36 ~ "decent",
    overall_survival_months < 60 ~ "good",
    overall_survival_months >= 60 ~ "Great"
    #overall_survival_months = Na ~ "Na"
    ),
    .after = overall_survival_months)



data |>
  select(overall_survival_months,survival)
```

## Add Clusters

Perform clustering of the gene/trancripts express to see which samples might be form a subtype of cancer. The clustering will be performed using the tidyclust packages.

```{r}
# First define how to cluster
# num_cluster are the numbers of clsuters to be formed
# Linage_mehtod is which method the formations of clusted should be based on.

data |>
  select(-c(1:30))

hc_spec <- hier_clust(
  num_clusters = 4,
  linkage_method = "average"
)


```

## Save augmented data

```{r}
# Save as .tsv file
write_tsv(
  data, 
  here("data/04_dat_augment.tsv")
  )
```
